(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,74064,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(72670);class r{static async initiateBattle(e,t){try{return console.log("Initiating battle with trainer..."),await a.default.makeRequest("/battle/initiate/"+e,"POST",t)}catch(e){throw console.error("Error initiating battle:",e),e}}static async continueBattle(e,t){try{return console.log("Continuing battle..."),console.log(t),await a.default.makeRequest("/battle/continue/"+e,"POST",t)}catch(e){throw console.error("Error continuing battle:",e),e}}}var l=e.i(23150),o=e.i(35389),n=e.i(90655);function i({m:e,os:s,onPokemonSelected:a,loading:r=!1}){return(0,t.jsxs)("div",{className:`p-[20px] font-sans ${r?"opacity-70 pointer-events-none":""}`,children:[(0,t.jsx)("h4",{className:"text-left font-bold mb-4",children:e}),(0,t.jsx)("div",{className:"flex flex-wrap justify-center gap-[20px]",children:s.map(e=>(0,t.jsxs)("div",{className:`w-[150px] bg-white border border-slate-400 rounded-[10px] p-[10px] text-center cursor-pointer shadow-md hover:shadow-lg transition-all duration-200 ${r?"cursor-not-allowed":""}`,onClick:()=>!r&&a(e),children:[(0,t.jsx)("img",{src:n.default.getImageURLForPokemon(e.o),alt:e.n,className:"w-auto h-[90px] object-contain mx-auto"}),(0,t.jsx)("p",{className:"my-[8px] font-bold cursor-pointer hover:text-[#3e3ee3] hover:underline",onClick:t=>{t.stopPropagation(),l.default.showInfo("pk",e.o)},children:e.n}),(0,t.jsx)("button",{onClick:t=>{t.stopPropagation(),r||a(e)},disabled:r,className:"px-[12px] py-[6px] bg-[#007bff] text-white border-none rounded-[10px] cursor-pointer hover:bg-[#0056b3] disabled:bg-gray-400 disabled:cursor-not-allowed",children:"Select"})]},e.i))})]})}var c=e.i(13420);function d({battle:e,onActionSelected:a,loading:r=!1}){let[o,i]=(0,s.useState)(null),[d,x]=(0,s.useState)(null),[p,u]=(0,s.useState)(!1),m=(o||d)&&!r&&!p;return(0,t.jsxs)("div",{className:`p-[20px] font-sans ${r?"opacity-70 pointer-events-none":""}`,children:[(0,t.jsxs)("div",{className:"flex justify-around mb-[20px]",children:[(0,t.jsxs)("div",{className:"relative w-[45%] text-center",children:[(0,t.jsxs)("div",{className:"flex justify-center items-center gap-[10px]",children:[(0,t.jsx)("h3",{className:"font-bold text-lg text-foreground",children:"Your "+e.cps?.n}),(0,t.jsx)("i",{className:"fa fa-info-circle text-[14px] cursor-pointer text-primary hover:text-primary/80",onClick:()=>l.default.showInfo("pk",e.cps?.o)})]}),(0,t.jsx)("img",{src:n.default.getImageURLForPokemon(e.cps?.o),alt:"Your Pokemon",className:"w-auto h-[120px] mb-[10px] mx-auto"}),(0,t.jsxs)("div",{className:"w-full bg-muted rounded-[10px] overflow-hidden my-[5px] flex items-center gap-[5px]",children:[(0,t.jsx)("div",{className:"bg-green-600 h-[15px] rounded-[5px] transition-all duration-500",style:{width:e.cps?e.cps.h/e.cps.th*100+"%":"0%"}}),(0,t.jsxs)("span",{className:"text-[13px] text-foreground px-1",children:[e.cps?.h,"/",e.cps?.th]})]}),(0,t.jsxs)("p",{className:"text-foreground",children:["Level ",e.cps?.l]}),(0,t.jsx)("div",{className:"flex justify-center gap-[5px] mt-1",children:e.cps?.ty?.map((e,s)=>(0,t.jsx)("div",{style:{backgroundColor:c.default.getTypeColor(e)},className:"text-white text-[12px] px-[6px] py-[2px] rounded-[4px]",title:e,children:e},s))})]}),(0,t.jsxs)("div",{className:"relative w-[45%] text-center",children:[(0,t.jsxs)("div",{className:"flex justify-center items-center gap-[10px]",children:[(0,t.jsx)("h3",{className:"font-bold text-lg text-foreground",children:e.op+"'s "+e.ops?.n}),(0,t.jsx)("i",{className:"fa fa-info-circle text-[14px] cursor-pointer text-primary hover:text-primary/80",onClick:()=>l.default.showInfo("pk",e.ops?.o)})]}),(0,t.jsx)("img",{src:n.default.getImageURLForPokemon(e.ops?.o),alt:"Opponent Pokemon",className:"w-auto h-[120px] mb-[10px] mx-auto"}),(0,t.jsxs)("div",{className:"w-full bg-muted rounded-[10px] overflow-hidden my-[5px] flex items-center gap-[5px]",children:[(0,t.jsx)("div",{className:"bg-green-600 h-[15px] rounded-[5px] transition-all duration-500",style:{width:e.ops?e.ops.h/e.ops.th*100+"%":"0%"}}),(0,t.jsxs)("span",{className:"text-[13px] text-foreground px-1",children:[e.ops?.h,"/",e.ops?.th]})]}),(0,t.jsxs)("p",{className:"text-foreground",children:["Level ",e.ops?.l]}),(0,t.jsx)("div",{className:"flex justify-center gap-[5px] mt-1",children:e.ops?.ty?.map((e,s)=>(0,t.jsx)("div",{style:{backgroundColor:c.default.getTypeColor(e)},className:"text-white text-[12px] px-[6px] py-[2px] rounded-[4px]",title:e,children:e},s))})]})]}),(0,t.jsx)("h4",{className:"text-left font-bold mb-4 text-foreground",children:e.m}),(0,t.jsxs)("div",{className:"flex flex-col md:flex-row justify-between gap-[20px] my-[20px]",children:[(0,t.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,t.jsx)("p",{className:"text-left font-bold mb-2 text-foreground",children:"Use an action:"}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-3",children:e.os?.map(e=>(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:"radio",id:e.i,value:e.i,checked:o===e.i,onChange:()=>{i(e.i),x(null)},name:"action",className:"hidden peer",disabled:r||p}),(0,t.jsxs)("label",{htmlFor:e.i,className:`block text-white p-[10px_15px] rounded-[10px] shadow-md cursor-pointer text-center transition-all duration-200 border-[3px] border-transparent 
                                    peer-checked:bg-opacity-95 peer-checked:border-white peer-checked:shadow-lg peer-checked:ring-4 peer-checked:ring-blue-400/50`,style:{backgroundColor:c.default.getTypeColor(e.t)},children:[(0,t.jsx)("span",{className:"text-sm",children:e.n}),(0,t.jsx)("i",{className:"fa fa-info-circle absolute right-[8px] top-[8px] text-[12px] text-[#dcdedf] hover:text-[#96989a]",onClick:t=>{t.preventDefault(),l.default.showInfo("m",e.i)}})]})]},e.i))})]}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,t.jsx)("p",{className:"text-left font-bold mb-2 text-foreground",children:"Use an item:"}),e.im?.map(e=>(0,t.jsxs)("div",{className:"relative m-[10px] mx-[15%]",children:[(0,t.jsx)("input",{type:"radio",id:"item-input"+e.i,value:e.i,checked:d?.i===e.i,onChange:()=>{x(e),i(null)},disabled:!!o||r||p,name:"item",className:"hidden peer"}),(0,t.jsx)("label",{htmlFor:"item-input"+e.i,className:`block bg-gray-500 text-white p-[10px_20px] rounded-[10px] shadow-md cursor-pointer text-center transition-all duration-200 border-[3px] border-transparent 
                                peer-checked:bg-gray-700 peer-checked:border-white peer-checked:shadow-lg peer-checked:ring-4 peer-checked:ring-blue-400/50`,children:e.n})]},e.i))]})]}),(0,t.jsx)("button",{disabled:!m,onClick:()=>{u(!0),a(o?{type:"action",item:o}:{type:"medicine",item:d}),setTimeout(()=>{u(!1)},2e3)},className:"bg-primary text-primary-foreground border-none px-6 py-3 rounded-lg cursor-pointer hover:bg-primary/90 disabled:bg-muted disabled:text-muted-foreground disabled:cursor-not-allowed block mx-auto transition-all duration-200 shadow-md hover:shadow-lg font-medium",children:r||p?"Processing...":"Continue"})]})}var x=e.i(18566);function p({battle:e,t:a}){let[l,o]=(0,s.useState)({}),n=(0,x.useRouter)();return(0,s.useEffect)(()=>{!async function(){console.log("ending battle now"),o(await r.continueBattle(a,{cs:9}))}()},[a]),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h4",{className:"text-xl font-bold mb-4",children:e.m}),(0,t.jsx)("br",{}),l.ts?.map((e,s)=>(0,t.jsx)("p",{className:"mb-2",children:e},s)),(0,t.jsx)("br",{}),(0,t.jsx)("button",{onClick:()=>{n.push("/map")},className:"bg-[#3f51b5] text-white border-none px-[20px] py-[10px] rounded-[10px] cursor-pointer hover:bg-[#303f9f]",children:"Back to Map"})]})}function u(){let[e,a]=(0,s.useState)(!0),[n,c]=(0,s.useState)(null),[x,u]=(0,s.useState)(null),[m,h]=(0,s.useState)(null),[f,g]=(0,s.useState)(null),[b,j]=(0,s.useState)(null);(0,s.useEffect)(()=>{console.log("Battle created");let e=async e=>{h(e.ci),g(e.ai),j(e.t),a(!0),console.log("Initiating battle");try{let t=await r.initiateBattle(e.t,{cs:null,ci:e.ci,ai:e.ai});y(t)}catch(e){l.default.error("an error occurred while starting the battle.",e)}finally{a(!1)}};return o.default.on("bd",e),()=>{o.default.off("bd",e)}},[]);let y=e=>{u(e),1===e.ns||6===e.ns?c("SELECT_PET"):2===e.ns||7===e.ns?c("SELECT_ACTION"):5===e.ns||9===e.ns?c("END_BATTLE"):l.default.warn("Unexpected battle state: "+e.ns)},N=async e=>{if(b)try{a(!0);let t=await r.continueBattle(b,{cs:6,oi:e.i});console.log(t),o.default.emit("battle-update",t.ts),y(t)}catch(e){l.default.error("an error occurred while selecting the pokemon.",e)}finally{a(!1)}},v=async e=>{if(b)try{a(!0);let t=await r.continueBattle(b,{cs:7,oi:e.item});console.log(t),o.default.emit("battle-update",t.ts),y(t)}catch(e){l.default.error("an error occurred while performing the action.",e)}finally{a(!1)}};return(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Battle"}),e&&!x&&(0,t.jsx)("div",{className:"text-[18px] text-[#555]",children:"Loading..."}),(0,t.jsxs)("div",{children:["SELECT_PET"===n&&x&&(0,t.jsx)(i,{m:x.m,os:x.os,onPokemonSelected:N,loading:e}),"SELECT_ACTION"===n&&x&&(0,t.jsx)(d,{battle:x,onActionSelected:v,loading:e}),"END_BATTLE"===n&&x&&b&&(0,t.jsx)(p,{battle:x,t:b}),!n&&!e&&(0,t.jsx)("div",{children:"Waiting for battle to start..."})]})]})}e.s(["default",()=>u],74064)}]);