(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,22361,e=>{"use strict";let t,a,s,i,r;var n=e.i(43476),o=e.i(71645),l=e.i(47760);let h={extension:{type:l.ExtensionType.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await e.A(86043)}},d={extension:{type:l.ExtensionType.Environment,name:"webworker",priority:0},test:()=>"undefined"!=typeof self&&void 0!==self.WorkerGlobalScope,load:async()=>{await e.A(62925)}};e.i(10463),e.i(99650),e.i(58035),e.i(95932),l.extensions.add(h,d);var c=e.i(27402),p=e.i(2351);async function u(e={}){return void 0!==a?a:a=await (async()=>{let t=c.DOMAdapter.get().getNavigator().gpu;if(!t)return!1;try{let a=await t.requestAdapter(e);return await a.requestDevice(),!0}catch(e){return!1}})()}let m=["webgl","webgpu","canvas"];async function g(a){let s,i=[];a.preference?(i.push(a.preference),m.forEach(e=>{e!==a.preference&&i.push(e)})):i=m.slice();let r={};for(let n=0;n<i.length;n++){let o=i[n];if("webgpu"===o&&await u()){let{WebGPURenderer:t}=await e.A(53088);s=t,r={...a,...a.webgpu};break}if("webgl"===o&&function(e){return void 0!==t?t:t=(()=>{let t={stencil:!0,failIfMajorPerformanceCaveat:e??p.AbstractRenderer.defaultOptions.failIfMajorPerformanceCaveat};try{if(!c.DOMAdapter.get().getWebGLRenderingContext())return!1;let e=c.DOMAdapter.get().createCanvas().getContext("webgl",t),a=!!e?.getContextAttributes()?.stencil;if(e){let t=e.getExtension("WEBGL_lose_context");t&&t.loseContext()}return e=null,a}catch(e){return!1}})()}(a.failIfMajorPerformanceCaveat??p.AbstractRenderer.defaultOptions.failIfMajorPerformanceCaveat)){let{WebGLRenderer:t}=await e.A(99331);s=t,r={...a,...a.webgl};break}if("canvas"===o)throw r={...a},Error("CanvasRenderer is not yet implemented")}if(delete r.webgpu,delete r.webgl,!s)throw Error("No available renderer for the current environment");let n=new s;return await n.init(r),n}var f=e.i(50147),A=e.i(81834),y=e.i(49864);let v=class e{constructor(...e){this.stage=new f.Container,void 0!==e[0]&&(0,y.deprecation)(y.v8_0_0,"Application constructor options are deprecated, please use Application.init() instead.")}async init(t){t={...t},this.stage||(this.stage=new f.Container),this.renderer=await g(t),e._plugins.forEach(e=>{e.init.call(this,t)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return(0,y.deprecation)(y.v8_0_0,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(t=!1,a=!1){let s=e._plugins.slice(0);s.reverse(),s.forEach(e=>{e.destroy.call(this)}),this.stage.destroy(a),this.stage=null,this.renderer.destroy(t),this.renderer=null}};v._plugins=[],l.extensions.handleByList(l.ExtensionType.Application,v._plugins),l.extensions.add(A.ApplicationInitHook);var x=e.i(81324),w=e.i(72116),b=e.i(30774),_=e.i(56881),P=e.i(63646),T=e.i(31320),C=e.i(30524),E=e.i(3248);class I extends C.AbstractBitmapFont{constructor(e,t){super();const{textures:a,data:s}=e;Object.keys(s.pages).forEach(e=>{let t=a[s.pages[parseInt(e,10)].id];this.pages.push({texture:t})}),Object.keys(s.chars).forEach(e=>{let t=s.chars[e],{frame:i,source:r,rotate:n}=a[t.page],o=_.groupD8.transformRectCoords(t,i,n,new P.Rectangle),l=new T.Texture({frame:o,orig:new P.Rectangle(0,0,t.width,t.height),source:r,rotate:n});this.chars[e]={id:e.codePointAt(0),xOffset:t.xOffset,yOffset:t.yOffset,xAdvance:t.xAdvance,kerning:t.kerning??{},texture:l}}),this.baseRenderedFontSize=s.fontSize,this.baseMeasurementFontSize=s.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:s.fontSize},this.baseLineOffset=s.baseLineOffset,this.lineHeight=s.lineHeight,this.fontFamily=s.fontFamily,this.distanceField=s.distanceField??{type:"none",range:0},this.url=t}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){let{texture:t}=this.pages[e];t.destroy(!0)}this.pages=null}static install(e){E.BitmapFontManager.install(e)}static uninstall(e){E.BitmapFontManager.uninstall(e)}}let L={test:e=>"string"==typeof e&&e.startsWith("info face="),parse(e){let t=e.match(/^[a-z]+\s+.+$/gm),a={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(let e in t){let s=t[e].match(/^[a-z]+/gm)[0],i=t[e].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),r={};for(let e in i){let t=i[e].split("="),a=t[0],s=t[1].replace(/"/gm,""),n=parseFloat(s),o=isNaN(n)?s:n;r[a]=o}a[s].push(r)}let s={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[i]=a.info,[r]=a.common,[n]=a.distanceField??[];n&&(s.distanceField={range:parseInt(n.distanceRange,10),type:n.fieldType}),s.fontSize=parseInt(i.size,10),s.fontFamily=i.face,s.lineHeight=parseInt(r.lineHeight,10);let o=a.page;for(let e=0;e<o.length;e++)s.pages.push({id:parseInt(o[e].id,10)||0,file:o[e].file});let l={};s.baseLineOffset=s.lineHeight-parseInt(r.base,10);let h=a.char;for(let e=0;e<h.length;e++){let t=h[e],a=parseInt(t.id,10),i=t.letter??t.char??String.fromCharCode(a);"space"===i&&(i=" "),l[a]=i,s.chars[i]={id:a,page:parseInt(t.page,10)||0,x:parseInt(t.x,10),y:parseInt(t.y,10),width:parseInt(t.width,10),height:parseInt(t.height,10),xOffset:parseInt(t.xoffset,10),yOffset:parseInt(t.yoffset,10),xAdvance:parseInt(t.xadvance,10),kerning:{}}}let d=a.kerning||[];for(let e=0;e<d.length;e++){let t=parseInt(d[e].first,10),a=parseInt(d[e].second,10),i=parseInt(d[e].amount,10);s.chars[l[a]].kerning[l[t]]=i}return s}},k={test:e=>"string"!=typeof e&&"getElementsByTagName"in e&&e.getElementsByTagName("page").length&&null!==e.getElementsByTagName("info")[0].getAttribute("face"),parse(e){let t={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},a=e.getElementsByTagName("info")[0],s=e.getElementsByTagName("common")[0],i=e.getElementsByTagName("distanceField")[0];i&&(t.distanceField={type:i.getAttribute("fieldType"),range:parseInt(i.getAttribute("distanceRange"),10)});let r=e.getElementsByTagName("page"),n=e.getElementsByTagName("char"),o=e.getElementsByTagName("kerning");t.fontSize=parseInt(a.getAttribute("size"),10),t.fontFamily=a.getAttribute("face"),t.lineHeight=parseInt(s.getAttribute("lineHeight"),10);for(let e=0;e<r.length;e++)t.pages.push({id:parseInt(r[e].getAttribute("id"),10)||0,file:r[e].getAttribute("file")});let l={};t.baseLineOffset=t.lineHeight-parseInt(s.getAttribute("base"),10);for(let e=0;e<n.length;e++){let a=n[e],s=parseInt(a.getAttribute("id"),10),i=a.getAttribute("letter")??a.getAttribute("char")??String.fromCharCode(s);"space"===i&&(i=" "),l[s]=i,t.chars[i]={id:s,page:parseInt(a.getAttribute("page"),10)||0,x:parseInt(a.getAttribute("x"),10),y:parseInt(a.getAttribute("y"),10),width:parseInt(a.getAttribute("width"),10),height:parseInt(a.getAttribute("height"),10),xOffset:parseInt(a.getAttribute("xoffset"),10),yOffset:parseInt(a.getAttribute("yoffset"),10),xAdvance:parseInt(a.getAttribute("xadvance"),10),kerning:{}}}for(let e=0;e<o.length;e++){let a=parseInt(o[e].getAttribute("first"),10),s=parseInt(o[e].getAttribute("second"),10),i=parseInt(o[e].getAttribute("amount"),10);t.chars[l[s]].kerning[l[a]]=i}return t}},B=e=>!!("string"==typeof e&&e.match(/<font(\s|>)/))&&k.test(c.DOMAdapter.get().parseXML(e)),F=e=>k.parse(c.DOMAdapter.get().parseXML(e)),O=[".xml",".fnt"],M={extension:{type:l.ExtensionType.CacheParser,name:"cacheBitmapFont"},test:e=>e instanceof I,getCacheableAssets(e,t){let a={};return e.forEach(e=>{a[e]=t,a[`${e}-bitmap`]=t}),a[`${t.fontFamily}-bitmap`]=t,a}},S={extension:{type:l.ExtensionType.LoadParser,priority:x.LoaderParserPriority.Normal},name:"loadBitmapFont",id:"bitmap-font",test:e=>O.includes(b.path.extname(e).toLowerCase()),testParse:async e=>L.test(e)||B(e),async parse(e,t,a){let s=L.test(e)?L.parse(e):F(e),{src:i}=t,{pages:r}=s,n=[],o=s.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let e=0;e<r.length;++e){let t=r[e].file,a=b.path.join(b.path.dirname(i),t);a=(0,w.copySearchParams)(a,i),n.push({src:a,data:o})}let l=await a.load(n);return new I({data:s,textures:n.map(e=>l[e.src])},i)},async load(e,t){let a=await c.DOMAdapter.get().fetch(e);return await a.text()},async unload(e,t,a){await Promise.all(e.pages.map(e=>a.unload(e.texture.source._sourceOrigin))),e.destroy()}};var R=e.i(85830);class j{constructor(e,t=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=t}add(e){e.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;let e=[],t=Math.min(this._assetList.length,this._maxConcurrent);for(let a=0;a<t;a++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}var U=e.i(92206);let W={extension:{type:l.ExtensionType.CacheParser,name:"cacheTextureArray"},test:e=>Array.isArray(e)&&e.every(e=>e instanceof T.Texture),getCacheableAssets:(e,t)=>{let a={};return e.forEach(e=>{t.forEach((t,s)=>{a[e+(0===s?"":s+1)]=t})}),a}};async function D(e){if("Image"in globalThis)return new Promise(t=>{let a=new Image;a.onload=()=>{t(!0)},a.onerror=()=>{t(!1)},a.src=e});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{let t=await (await fetch(e)).blob();await createImageBitmap(t)}catch(e){return!1}return!0}return!1}let z={extension:{type:l.ExtensionType.DetectionParser,priority:1},test:async()=>D("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async e=>[...e,"avif"],remove:async e=>e.filter(e=>"avif"!==e)},$=["png","jpg","jpeg"],N={extension:{type:l.ExtensionType.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async e=>[...e,...$],remove:async e=>e.filter(e=>!$.includes(e))},H="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function G(e){return!H&&""!==document.createElement("video").canPlayType(e)}let V={extension:{type:l.ExtensionType.DetectionParser,priority:0},test:async()=>G("video/mp4"),add:async e=>[...e,"mp4","m4v"],remove:async e=>e.filter(e=>"mp4"!==e&&"m4v"!==e)},q={extension:{type:l.ExtensionType.DetectionParser,priority:0},test:async()=>G("video/ogg"),add:async e=>[...e,"ogv"],remove:async e=>e.filter(e=>"ogv"!==e)},Q={extension:{type:l.ExtensionType.DetectionParser,priority:0},test:async()=>G("video/webm"),add:async e=>[...e,"webm"],remove:async e=>e.filter(e=>"webm"!==e)},Y={extension:{type:l.ExtensionType.DetectionParser,priority:0},test:async()=>D("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async e=>[...e,"webp"],remove:async e=>e.filter(e=>"webp"!==e)};var X=e.i(89698),Z=e.i(24103);let K=class e{constructor(){this.loadOptions={...e.defaultOptions},this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,t,a)=>(this._parsersValidated=!1,e[t]=a,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,t){let a={promise:null,parser:null};return a.promise=(async()=>{let s=null,i=null;if((t.parser||t.loadParser)&&(i=this._parserHash[t.parser||t.loadParser],t.loadParser&&(0,R.warn)(`[Assets] "loadParser" is deprecated, use "parser" instead for ${e}`),i||(0,R.warn)(`[Assets] specified load parser "${t.parser||t.loadParser}" not found while loading ${e}`)),!i){for(let a=0;a<this.parsers.length;a++){let s=this.parsers[a];if(s.load&&s.test?.(e,t,this)){i=s;break}}if(!i)return(0,R.warn)(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}s=await i.load(e,t,this),a.parser=i;for(let e=0;e<this.parsers.length;e++){let i=this.parsers[e];i.parse&&i.parse&&await i.testParse?.(s,t,this)&&(s=await i.parse(s,t,this)||s,a.parser=i)}return s})(),a}async load(t,a){this._parsersValidated||this._validateParsers();let{onProgress:s,onError:i,strategy:r,retryCount:n,retryDelay:o}="function"==typeof a?{...e.defaultOptions,...this.loadOptions,onProgress:a}:{...e.defaultOptions,...this.loadOptions,...a||{}},l=0,h={},d=(0,Z.isSingleItem)(t),c=(0,X.convertToList)(t,e=>({alias:[e],src:e,data:{}})),p=c.reduce((e,t)=>e+(t.progressSize||1),0),u=c.map(async e=>{let t=b.path.toAbsolute(e.src);!h[e.src]&&(await this._loadAssetWithRetry(t,e,{onProgress:s,onError:i,strategy:r,retryCount:n,retryDelay:o},h),l+=e.progressSize||1,s&&s(l/p))});return await Promise.all(u),d?h[c[0].src]:h}async unload(e){let t=(0,X.convertToList)(e,e=>({alias:[e],src:e})).map(async e=>{let t=b.path.toAbsolute(e.src),a=this.promiseCache[t];if(a){let s=await a.promise;delete this.promiseCache[t],await a.parser?.unload?.(s,e,this)}});await Promise.all(t)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name||e.id).reduce((e,t)=>(t.name||t.id?(e[t.name]||e[t.id])&&(0,R.warn)(`[Assets] parser id conflict "${t.id}"`):(0,R.warn)("[Assets] parser should have an id"),e[t.name]=t,t.id&&(e[t.id]=t),e),{})}async _loadAssetWithRetry(e,t,a,s){let i=0,{onError:r,strategy:n,retryCount:o,retryDelay:l}=a,h=e=>new Promise(t=>setTimeout(t,e));for(;;)try{this.promiseCache[e]||(this.promiseCache[e]=this._getLoadPromiseAndParser(e,t)),s[t.src]=await this.promiseCache[e].promise;return}catch(d){delete this.promiseCache[e],delete s[t.src],i++;let a="retry"!==n||i>o;if("retry"===n&&!a){r&&r(d,t),await h(l);continue}if("skip"===n){r&&r(d,t);return}throw r&&r(d,t),Error(`[Loader.load] Failed to load ${e}.
${d}`)}}};function J(e,t){if(Array.isArray(t)){for(let a of t)if(e.startsWith(`data:${a}`))return!0;return!1}return e.startsWith(`data:${t}`)}function ee(e,t){let a=e.split("?")[0],s=b.path.extname(a).toLowerCase();return Array.isArray(t)?t.includes(s):s===t}K.defaultOptions={onProgress:void 0,onError:void 0,strategy:"throw",retryCount:3,retryDelay:250};let et={extension:{type:l.ExtensionType.LoadParser,priority:x.LoaderParserPriority.Low},name:"loadJson",id:"json",test:e=>J(e,"application/json")||ee(e,".json"),async load(e){let t=await c.DOMAdapter.get().fetch(e);return await t.json()}},ea={name:"loadTxt",id:"text",extension:{type:l.ExtensionType.LoadParser,priority:x.LoaderParserPriority.Low,name:"loadTxt"},test:e=>J(e,"text/plain")||ee(e,".txt"),async load(e){let t=await c.DOMAdapter.get().fetch(e);return await t.text()}},es=["normal","bold","100","200","300","400","500","600","700","800","900"],ei=[".ttf",".otf",".woff",".woff2"],er=["font/ttf","font/otf","font/woff","font/woff2"],en=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i,eo=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/,el={extension:{type:l.ExtensionType.LoadParser,priority:x.LoaderParserPriority.Low},name:"loadWebFont",id:"web-font",test:e=>J(e,er)||ee(e,ei),async load(e,t){let a=c.DOMAdapter.get().getFontFaceSet();if(a){let s=[],i=t.data?.family??function(e){let t=b.path.extname(e),a=b.path.basename(e,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)),s=a.length>0;for(let e of a)if(!e.match(en)){s=!1;break}let i=a.join(" ");return s||(i=`"${i.replace(/[\\"]/g,"\\$&")}"`),i}(e),r=t.data?.weights?.filter(e=>es.includes(e))??["normal"],n=t.data??{};for(let t=0;t<r.length;t++){let o=r[t],l=new FontFace(i,`url(${eo.test(e)?e:encodeURI(e)})`,{...n,weight:o});await l.load(),a.add(l),s.push(l)}return U.Cache.has(`${i}-and-url`)?U.Cache.get(`${i}-and-url`).entries.push({url:e,faces:s}):U.Cache.set(`${i}-and-url`,{entries:[{url:e,faces:s}]}),1===s.length?s[0]:s}return(0,R.warn)("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(e){let t=Array.isArray(e)?e:[e],a=t[0].family,s=U.Cache.get(`${a}-and-url`),i=s.entries.find(e=>e.faces.some(e=>-1!==t.indexOf(e)));i.faces=i.faces.filter(e=>-1===t.indexOf(e)),0===i.faces.length&&(s.entries=s.entries.filter(e=>e!==i)),t.forEach(e=>{c.DOMAdapter.get().getFontFaceSet().delete(e)}),0===s.entries.length&&U.Cache.remove(`${a}-and-url`)}};var eh=e.i(16203),ed=e.i(20446),ec=e.i(39260);function ep(e,t=1){let a=ec.Resolver.RETINA_PREFIX?.exec(e);return a?parseFloat(a[1]):t}function eu(e,t,a){e.label=a,e._sourceOrigin=a;let s=new T.Texture({source:e,label:a}),i=()=>{delete t.promiseCache[a],U.Cache.has(a)&&U.Cache.remove(a)};return s.source.once("destroy",()=>{t.promiseCache[a]&&((0,R.warn)("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),i())}),s.once("destroy",()=>{e.destroyed||((0,R.warn)("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),i())}),s}let em={extension:{type:l.ExtensionType.LoadParser,priority:x.LoaderParserPriority.Low,name:"loadSVG"},name:"loadSVG",id:"svg",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test:e=>J(e,"image/svg+xml")||ee(e,".svg"),async load(e,t,a){return t.data?.parseAsGraphicsContext??this.config.parseAsGraphicsContext?ef(e):eg(e,t,a,this.config.crossOrigin)},unload(e){e.destroy(!0)}};async function eg(e,t,a,s){let i=await c.DOMAdapter.get().fetch(e),r=c.DOMAdapter.get().createImage();r.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(await i.text())}`,r.crossOrigin=s,await r.decode();let n=t.data?.width??r.width,o=t.data?.height??r.height,l=t.data?.resolution||ep(e),h=Math.ceil(n*l),d=Math.ceil(o*l),p=c.DOMAdapter.get().createCanvas(h,d),u=p.getContext("2d");u.imageSmoothingEnabled=!0,u.imageSmoothingQuality="high",u.drawImage(r,0,0,n*l,o*l);let{parseAsGraphicsContext:m,...g}=t.data??{};return eu(new eh.ImageSource({resource:p,alphaMode:"premultiply-alpha-on-upload",resolution:l,...g}),a,e)}async function ef(e){let t=await c.DOMAdapter.get().fetch(e),a=await t.text(),s=new ed.GraphicsContext;return s.svg(a),s}let eA=null;class ey{constructor(){eA||(eA=URL.createObjectURL(new Blob(['(function () {\n    \'use strict\';\n\n    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";\n    async function checkImageBitmap() {\n      try {\n        if (typeof createImageBitmap !== "function")\n          return false;\n        const response = await fetch(WHITE_PNG);\n        const imageBlob = await response.blob();\n        const imageBitmap = await createImageBitmap(imageBlob);\n        return imageBitmap.width === 1 && imageBitmap.height === 1;\n      } catch (_e) {\n        return false;\n      }\n    }\n    void checkImageBitmap().then((result) => {\n      self.postMessage(result);\n    });\n\n})();\n'],{type:"application/javascript"}))),this.worker=new Worker(eA)}}ey.revokeObjectURL=function(){eA&&(URL.revokeObjectURL(eA),eA=null)};let ev=null;class ex{constructor(){ev||(ev=URL.createObjectURL(new Blob(['(function () {\n    \'use strict\';\n\n    async function loadImageBitmap(url, alphaMode) {\n      const response = await fetch(url);\n      if (!response.ok) {\n        throw new Error(`[WorkerManager.loadImageBitmap] Failed to fetch ${url}: ${response.status} ${response.statusText}`);\n      }\n      const imageBlob = await response.blob();\n      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);\n    }\n    self.onmessage = async (event) => {\n      try {\n        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);\n        self.postMessage({\n          data: imageBitmap,\n          uuid: event.data.uuid,\n          id: event.data.id\n        }, [imageBitmap]);\n      } catch (e) {\n        self.postMessage({\n          error: e,\n          uuid: event.data.uuid,\n          id: event.data.id\n        });\n      }\n    };\n\n})();\n'],{type:"application/javascript"}))),this.worker=new Worker(ev)}}ex.revokeObjectURL=function(){ev&&(URL.revokeObjectURL(ev),ev=null)};let ew=0,eb=new class{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return void 0!==this._isImageBitmapSupported||(this._isImageBitmapSupported=new Promise(e=>{let{worker:t}=new ey;t.addEventListener("message",a=>{t.terminate(),ey.revokeObjectURL(),e(a.data)})})),this._isImageBitmapSupported}loadImageBitmap(e,t){return this._run("loadImageBitmap",[e,t?.data?.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){void 0===s&&(s=navigator.hardwareConcurrency||4);let e=this._workerPool.pop();return!e&&this._createdWorkers<s&&(this._createdWorkers++,(e=new ex().worker).addEventListener("message",e=>{this._complete(e.data),this._returnWorker(e.target),this._next()})),e}_returnWorker(e){this._workerPool.push(e)}_complete(e){this._resolveHash[e.uuid]&&(void 0!==e.error?this._resolveHash[e.uuid].reject(e.error):this._resolveHash[e.uuid].resolve(e.data),delete this._resolveHash[e.uuid])}async _run(e,t){await this._initWorkers();let a=new Promise((a,s)=>{this._queue.push({id:e,arguments:t,resolve:a,reject:s})});return this._next(),a}_next(){if(!this._queue.length)return;let e=this._getWorker();if(!e)return;let t=this._queue.pop(),a=t.id;this._resolveHash[ew]={resolve:t.resolve,reject:t.reject},e.postMessage({data:t.arguments,uuid:ew++,id:a})}reset(){this._workerPool.forEach(e=>e.terminate()),this._workerPool.length=0,Object.values(this._resolveHash).forEach(({reject:e})=>{e?.(Error("WorkerManager has been reset before completion"))}),this._resolveHash={},this._queue.length=0,this._initialized=!1,this._createdWorkers=0}},e_=[".jpeg",".jpg",".png",".webp",".avif"],eP=["image/jpeg","image/png","image/webp","image/avif"];async function eT(e,t){let a=await c.DOMAdapter.get().fetch(e);if(!a.ok)throw Error(`[loadImageBitmap] Failed to fetch ${e}: ${a.status} ${a.statusText}`);let s=await a.blob();return t?.data?.alphaMode==="premultiplied-alpha"?createImageBitmap(s,{premultiplyAlpha:"none"}):createImageBitmap(s)}let eC={name:"loadTextures",id:"texture",extension:{type:l.ExtensionType.LoadParser,priority:x.LoaderParserPriority.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test:e=>J(e,eP)||ee(e,e_),async load(e,t,a){let s=null;return s=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await eb.isImageBitmapSupported()?await eb.loadImageBitmap(e,t):await eT(e,t):await new Promise((t,a)=>{(s=c.DOMAdapter.get().createImage()).crossOrigin=this.config.crossOrigin,s.src=e,s.complete?t(s):(s.onload=()=>{t(s)},s.onerror=a)}),eu(new eh.ImageSource({resource:s,alphaMode:"premultiply-alpha-on-upload",resolution:t.data?.resolution||ep(e),...t.data}),a,e)},unload(e){e.destroy(!0)}};var eE=e.i(97556),eI=e.i(16763);let eL=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"],ek={name:"loadVideo",id:"video",extension:{type:l.ExtensionType.LoadParser,name:"loadVideo"},test(e){if(!i||!r){let{validVideoExtensions:e,validVideoMime:t}=function(){let e=[],t=[];for(let a of eL){let s=eE.VideoSource.MIME_TYPES[a.substring(1)]||`video/${a.substring(1)}`;G(s)&&(e.push(a),t.includes(s)||t.push(s))}return{validVideoExtensions:e,validVideoMime:t}}();i=e,r=t}let t=J(e,r),a=ee(e,i);return t||a},async load(e,t,a){var s;let i,r={...eE.VideoSource.defaultOptions,resolution:t.data?.resolution||ep(e),alphaMode:t.data?.alphaMode||await (0,eI.detectVideoAlphaMode)(),...t.data},n=document.createElement("video"),o={preload:!1!==r.autoLoad?"auto":void 0,"webkit-playsinline":!1!==r.playsinline?"":void 0,playsinline:!1!==r.playsinline?"":void 0,muted:!0===r.muted?"":void 0,loop:!0===r.loop?"":void 0,autoplay:!1!==r.autoPlay?"":void 0};Object.keys(o).forEach(e=>{let t=o[e];void 0!==t&&n.setAttribute(e,t)}),!0===r.muted&&(n.muted=!0),void 0!==(s=r.crossorigin)||e.startsWith("data:")?!1!==s&&(n.crossOrigin="string"==typeof s?s:"anonymous"):n.crossOrigin=function(e,t=globalThis.location){if(e.startsWith("data:"))return"";t||(t=globalThis.location);let a=new URL(e,document.baseURI);return a.hostname!==t.hostname||a.port!==t.port||a.protocol!==t.protocol?"anonymous":""}(e);let l=document.createElement("source");if(r.mime)i=r.mime;else if(e.startsWith("data:"))i=e.slice(5,e.indexOf(";"));else if(!e.startsWith("blob:")){let t=e.split("?")[0].slice(e.lastIndexOf(".")+1).toLowerCase();i=eE.VideoSource.MIME_TYPES[t]||`video/${t}`}return l.src=e,i&&(l.type=i),new Promise(s=>{let i=async()=>{let o=new eE.VideoSource({...r,resource:n});n.removeEventListener("canplay",i),t.data.preload&&await new Promise((e,t)=>{function a(){i(),e()}function s(e){i(),t(e)}function i(){n.removeEventListener("canplaythrough",a),n.removeEventListener("error",s)}n.addEventListener("canplaythrough",a),n.addEventListener("error",s),n.load()}),s(eu(o,a,e))};r.preload&&!r.autoPlay&&n.load(),n.addEventListener("canplay",i),n.appendChild(l)})},unload(e){e.destroy(!0)}},eB={extension:{type:l.ExtensionType.ResolveParser,name:"resolveTexture"},test:eC.test,parse:e=>({resolution:parseFloat(ec.Resolver.RETINA_PREFIX.exec(e)?.[1]??"1"),format:e.split(".").pop(),src:e})},eF={extension:{type:l.ExtensionType.ResolveParser,priority:-2,name:"resolveJson"},test:e=>ec.Resolver.RETINA_PREFIX.test(e)&&e.endsWith(".json"),parse:eB.parse},eO=new class{constructor(){this._detections=[],this._initialized=!1,this.resolver=new ec.Resolver,this.loader=new K,this.cache=U.Cache,this._backgroundLoader=new j(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){if(this._initialized)return void(0,R.warn)("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let t=e.manifest;"string"==typeof t&&(t=await this.load(t)),this.resolver.addManifest(t)}let t=e.texturePreference?.resolution??1,a=await this._detectFormats({preferredFormats:e.texturePreference?.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:a,resolution:"number"==typeof t?[t]:t}}),e.preferences&&this.setPreferences(e.preferences),e.loadOptions&&(this.loader.loadOptions={...this.loader.loadOptions,...e.loadOptions})}add(e){this.resolver.add(e)}async load(e,t){this._initialized||await this.init();let a=(0,Z.isSingleItem)(e),s=(0,X.convertToList)(e).map(e=>{if("string"!=typeof e){let t=this.resolver.getAlias(e);return t.some(e=>!this.resolver.hasKey(e))&&this.add(e),Array.isArray(t)?t[0]:t}return this.resolver.hasKey(e)||this.add({alias:e,src:e}),e}),i=this.resolver.resolve(s),r=await this._mapLoadToResolve(i,t);return a?r[s[0]]:r}addBundle(e,t){this.resolver.addBundle(e,t)}async loadBundle(e,t){this._initialized||await this.init();let a=!1;"string"==typeof e&&(a=!0,e=[e]);let s=this.resolver.resolveBundle(e),i={},r=Object.keys(s),n=0,o=[],l=r.map((e,a)=>{let r=s[e],l=[...new Set(Object.values(r).flat())].reduce((e,t)=>e+(t.progressSize||1),0);return o.push(0),n+=l,this._mapLoadToResolve(r,e=>{o[a]=e*l,t?.(o.reduce((e,t)=>e+t,0)/n)}).then(t=>{i[e]=t})});return await Promise.all(l),a?i[e[0]]:i}async backgroundLoad(e){this._initialized||await this.init(),"string"==typeof e&&(e=[e]);let t=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(t))}async backgroundLoadBundle(e){this._initialized||await this.init(),"string"==typeof e&&(e=[e]),Object.values(this.resolver.resolveBundle(e)).forEach(e=>{this._backgroundLoader.add(Object.values(e))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if("string"==typeof e)return U.Cache.get(e);let t={};for(let a=0;a<e.length;a++)t[a]=U.Cache.get(e[a]);return t}async _mapLoadToResolve(e,t){let a=[...new Set(Object.values(e))];this._backgroundLoader.active=!1;let s=await this.loader.load(a,t);this._backgroundLoader.active=!0;let i={};return a.forEach(e=>{let t=s[e.src],a=[e.src];e.alias&&a.push(...e.alias),a.forEach(e=>{i[e]=t}),U.Cache.set(a,t)}),i}async unload(e){this._initialized||await this.init();let t=(0,X.convertToList)(e).map(e=>"string"!=typeof e?e.src:e),a=this.resolver.resolve(t);await this._unloadFromResolved(a)}async unloadBundle(e){this._initialized||await this.init(),e=(0,X.convertToList)(e);let t=this.resolver.resolveBundle(e),a=Object.keys(t).map(e=>this._unloadFromResolved(t[e]));await Promise.all(a)}async _unloadFromResolved(e){let t=Object.values(e);t.forEach(e=>{U.Cache.remove(e.src)}),await this.loader.unload(t)}async _detectFormats(e){let t=[];for(let a of(e.preferredFormats&&(t=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]),e.detections))e.skipDetections||await a.test()?t=await a.add(t):e.skipDetections||(t=await a.remove(t));return t=t.filter((e,a)=>t.indexOf(e)===a)}get detections(){return this._detections}setPreferences(e){this.loader.parsers.forEach(t=>{t.config&&Object.keys(t.config).filter(t=>t in e).forEach(a=>{t.config[a]=e[a]})})}};l.extensions.handleByList(l.ExtensionType.LoadParser,eO.loader.parsers).handleByList(l.ExtensionType.ResolveParser,eO.resolver.parsers).handleByList(l.ExtensionType.CacheParser,eO.cache.parsers).handleByList(l.ExtensionType.DetectionParser,eO.detections),l.extensions.add(W,N,z,Y,V,q,Q,et,ea,el,em,eC,ek,S,M,eB,eF);let eM={loader:l.ExtensionType.LoadParser,resolver:l.ExtensionType.ResolveParser,cache:l.ExtensionType.CacheParser,detection:l.ExtensionType.DetectionParser};l.extensions.handle(l.ExtensionType.Asset,e=>{let t=e.ref;Object.entries(eM).filter(([e])=>!!t[e]).forEach(([e,a])=>l.extensions.add(Object.assign(t[e],{extension:t[e].extension??a})))},e=>{let t=e.ref;Object.keys(eM).filter(e=>!!t[e]).forEach(e=>l.extensions.remove(t[e]))});var eS=e.i(40069),eR=e.i(59750),ej=e.i(6972),eU=eS;class eW extends eU.Sprite{constructor(...e){let t=e[0];Array.isArray(e[0])&&(t={textures:e[0],autoUpdate:e[1]});const{animationSpeed:a=1,autoPlay:s=!1,autoUpdate:i=!0,loop:r=!0,onComplete:n=null,onFrameChange:o=null,onLoop:l=null,textures:h,updateAnchor:d=!1,...c}=t,[p]=h;super({...c,texture:p instanceof T.Texture?p:p.texture}),this._textures=null,this._durations=null,this._autoUpdate=i,this._isConnectedToTicker=!1,this.animationSpeed=a,this.loop=r,this.updateAnchor=d,this.onComplete=n,this.onFrameChange=o,this.onLoop=l,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=h,s&&this.play()}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(ej.Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(ej.Ticker.shared.add(this.update,this,eR.UPDATE_PRIORITY.HIGH),this._isConnectedToTicker=!0))}gotoAndStop(e){this.stop(),this.currentFrame=e}gotoAndPlay(e){this.currentFrame=e,this.play()}update(e){if(!this._playing)return;let t=e.deltaTime,a=this.animationSpeed*t,s=this.currentFrame;if(null!==this._durations){let e=this._currentTime%1*this._durations[this.currentFrame];for(e+=a/60*1e3;e<0;)this._currentTime--,e+=this._durations[this.currentFrame];let s=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);e>=this._durations[this.currentFrame];)e-=this._durations[this.currentFrame]*s,this._currentTime+=s;this._currentTime+=e/this._durations[this.currentFrame]}else this._currentTime+=a;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):s!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<s||this.animationSpeed<0&&this.currentFrame>s)&&this.onLoop(),this._updateTexture())}_updateTexture(){let e=this.currentFrame;this._previousFrame!==e&&(this._previousFrame=e,this.texture=this._textures[e],this.updateAnchor&&this.texture.defaultAnchor&&this.anchor.copyFrom(this.texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}destroy(e=!1){if("boolean"==typeof e?e:e?.texture){let t="boolean"==typeof e?e:e?.textureSource;this._textures.forEach(e=>{this.texture!==e&&e.destroy(t)})}this._textures=[],this._durations=null,this.stop(),super.destroy(e),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}static fromFrames(e){let t=[];for(let a=0;a<e.length;++a)t.push(T.Texture.from(e[a]));return new eW(t)}static fromImages(e){let t=[];for(let a=0;a<e.length;++a)t.push(T.Texture.from(e[a]));return new eW(t)}get totalFrames(){return this._textures.length}get textures(){return this._textures}set textures(e){if(e[0]instanceof T.Texture)this._textures=e,this._durations=null;else{this._textures=[],this._durations=[];for(let t=0;t<e.length;t++)this._textures.push(e[t].texture),this._durations.push(e[t].time)}this._previousFrame=null,this.gotoAndStop(0),this._updateTexture()}get currentFrame(){let e=Math.floor(this._currentTime)%this._textures.length;return e<0&&(e+=this._textures.length),e}set currentFrame(e){if(e<0||e>this.totalFrames-1)throw Error(`[AnimatedSprite]: Invalid frame index value ${e}, expected to be between 0 and totalFrames ${this.totalFrames}.`);let t=this.currentFrame;this._currentTime=e,t!==this.currentFrame&&this._updateTexture()}get playing(){return this._playing}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(ej.Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(ej.Ticker.shared.add(this.update,this),this._isConnectedToTicker=!0))}}var eD=e.i(72670);class ez{containerId;app;map;avatar;camera;uninhabitableAreas;currentPosition;targetCameraPosition;cameraPosition;apiUrls;textures=null;currentDirection="down";isMoving=!1;constructor(e){this.containerId=e,this.app=null,this.map=null,this.avatar=null,this.camera=null,this.uninhabitableAreas=[],this.currentPosition={x:0,y:0},this.targetCameraPosition={x:0,y:0},this.cameraPosition={x:0,y:0},this.apiUrls={uninhabitable:"/api/getUninhabitableAreas",previousLocation:"/api/getPreviousLocation",saveLocation:"/api/saveLocation",userAssets:"/api/getUserAssets"}}async init(){let e=document.getElementById(this.containerId);if(!e)return void console.error("Container element not found!");let t=e.clientWidth||800,a=e.clientHeight||600;this.app=new v,await this.app.init({width:t,height:a,backgroundAlpha:0,resizeTo:e}),e.appendChild(this.app.canvas),eO.add({alias:"map",src:"/assets/map/route_1.png"}),eO.add({alias:"avatar",src:"/assets/avatar/blue-hair.png"}),await eO.load(["map","avatar"]),this.setup()}async setup(){if(!this.app)return;this.map=new f.Container;let e=eO.get("map"),t=new eS.Sprite(e);t.scale.set(2),t.roundPixels=!0,this.map.addChild(t);let a=eO.get("avatar");this.textures={down:[],left:[],right:[],up:[]};let s=(e,t)=>[t[0],e,t[1],e].map(e=>{let t=new P.Rectangle(32*e.c,32*e.r,32,32);return new T.Texture({source:a.source,frame:t})});this.textures.up=s({r:0,c:0},[{r:0,c:2},{r:3,c:1}]),this.textures.down=s({r:1,c:2},[{r:2,c:2},{r:3,c:2}]),this.textures.left=s({r:2,c:0},[{r:1,c:0},{r:3,c:0}]),this.textures.right=s({r:0,c:1},[{r:1,c:1},{r:2,c:1}]),this.avatar=new eW(this.textures.down),this.avatar.animationSpeed=.15,this.avatar.roundPixels=!0,this.avatar.loop=!0,this.avatar.anchor.set(.5),this.avatar.scale.set(1.5),this.avatar.position.set(400,300),this.avatar.gotoAndStop(1),this.map.addChild(this.avatar),this.camera=new f.Container,this.camera.addChild(this.map),this.app.stage.addChild(this.camera),this.centerCamera(),this.camera&&(this.camera.position.set(this.targetCameraPosition.x,this.targetCameraPosition.y),this.cameraPosition={x:this.targetCameraPosition.x,y:this.targetCameraPosition.y}),this.app.ticker.add(()=>this.smoothCamera()),console.log("Map setup complete. Map size:",t.width,"x",t.height)}move(e){if(!this.avatar||!this.app||!this.textures)return;let t=e.toLowerCase();this.currentDirection!==t?(this.currentDirection=t,this.avatar.textures=this.textures[t],this.avatar.gotoAndPlay(0)):this.avatar.playing||this.avatar.gotoAndPlay(0),this.isMoving=!0;let a=this.avatar.x,s=this.avatar.y;switch(t){case"up":s-=3;break;case"down":s+=3;break;case"left":a-=3;break;case"right":a+=3}if(this.isUninhabitable(a,s))return;let i=this.map.width/this.map.scale.x,r=this.map.height/this.map.scale.y;a<16&&(a=16),s<16&&(s=16),a>i-16&&(a=i-16),s>r-16&&(s=r-16),this.avatar.x=a,this.avatar.y=s,this.updateCamera()}stop(){this.avatar&&this.textures&&(this.isMoving=!1,this.avatar.stop(),this.avatar.gotoAndStop(1))}centerCamera(){if(!this.camera||!this.avatar||!this.app||!this.map)return;let e=this.app.screen.width,t=this.app.screen.height,a=this.map.scale.x,s=-this.avatar.x*a+e/2,i=-this.avatar.y*a+t/2;this.clampAndSetCamera(s,i)}updateCamera(){if(!this.camera||!this.avatar||!this.app||!this.map)return;let e=this.app.screen.width,t=this.app.screen.height,a=this.map.scale.x,s=.3*e,i=.3*t,r=this.targetCameraPosition.x,n=this.targetCameraPosition.y,o=this.avatar.x*a+r,l=this.avatar.y*a+n;o<s?r=s-this.avatar.x*a:o>e-s&&(r=e-s-this.avatar.x*a),l<i?n=i-this.avatar.y*a:l>t-i&&(n=t-i-this.avatar.y*a),this.clampAndSetCamera(r,n)}clampAndSetCamera(e,t){if(!this.app||!this.map)return;let a=this.app.screen.width,s=this.app.screen.height,i=this.map.width,r=this.map.height;e=i<a?(a-i)/2:Math.max(a-i,Math.min(0,e)),t=r<s?(s-r)/2:Math.max(s-r,Math.min(0,t)),this.targetCameraPosition={x:e,y:t}}smoothCamera(){this.camera&&(this.cameraPosition.x+=(this.targetCameraPosition.x-this.cameraPosition.x)*.2,this.cameraPosition.y+=(this.targetCameraPosition.y-this.cameraPosition.y)*.2,this.camera.x=Math.round(this.cameraPosition.x),this.camera.y=Math.round(this.cameraPosition.y))}isUninhabitable(e,t){return this.uninhabitableAreas.some(a=>32>Math.sqrt(Math.pow(a.x-e,2)+Math.pow(a.y-t,2)))}async fetchUninhabitableAreas(){return await eD.default.makeRequest(this.apiUrls.uninhabitable)}async fetchPreviousLocation(){return await eD.default.makeRequest(this.apiUrls.previousLocation)}async fetchUserAssets(){return await eD.default.makeRequest(this.apiUrls.userAssets)}async saveCurrentLocation(){this.avatar&&await eD.default.makeRequest(this.apiUrls.saveLocation,"POST",{x:this.avatar.x,y:this.avatar.y})}destroy(){this.app&&(this.app.destroy(!0,{children:!0,texture:!0}),this.app=null)}}var e$=e.i(35389);function eN(){let e=(0,o.useRef)(null),t=(0,o.useRef)(null),[a,s]=(0,o.useState)(null),[i,r]=(0,o.useState)(!0),[l,h]=(0,o.useState)(!1);return((0,o.useEffect)(()=>{h(!0)},[]),(0,o.useEffect)(()=>{if(!l)return;let a=!0;return(async()=>{if(e.current&&!t.current&&a)try{r(!0),s(null);let e=new ez("map-container");t.current=e,await e.init();let i=t=>{e.move(t)},n=()=>{e.stop()};e$.default.on("map-move",i),e$.default.on("map-stop",n);let o=()=>e.saveCurrentLocation();return window.addEventListener("beforeunload",o),r(!1),()=>{e$.default.off("map-move",i),e$.default.off("map-stop",n),window.removeEventListener("beforeunload",o),a&&(e.destroy(),t.current=null)}}catch(e){console.error("Failed to initialize map:",e),s("Failed to load map. Please refresh the page."),r(!1)}})(),()=>{a=!1,t.current&&(t.current.destroy(),t.current=null)}},[l]),l)?a?(0,n.jsx)("div",{className:"flex items-center justify-center p-[20px] bg-[#8794e3] rounded-[10px] w-full min-h-[600px]",children:(0,n.jsxs)("div",{className:"text-white text-center",children:[(0,n.jsxs)("p",{className:"text-xl font-bold mb-2",children:["⚠️ ",a]}),(0,n.jsx)("button",{onClick:()=>window.location.reload(),className:"bg-white text-[#8794e3] px-4 py-2 rounded-lg hover:bg-gray-100",children:"Reload Page"})]})}):(0,n.jsxs)("div",{className:"relative w-full h-full",children:[i&&(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-[#8794e3] rounded-[10px] z-10",children:(0,n.jsx)("p",{className:"text-white text-xl",children:"Loading map..."})}),(0,n.jsx)("div",{id:"map-container",ref:e,className:"flex items-center justify-center p-[5px] bg-[#8794e3] rounded-[10px] w-full h-full overflow-hidden"})]}):(0,n.jsx)("div",{className:"flex items-center justify-center p-[20px] bg-[#8794e3] rounded-[10px] w-full min-h-[600px]",children:(0,n.jsx)("p",{className:"text-white text-xl",children:"Loading..."})})}e.s(["default",()=>eN],22361)},67362,e=>{e.n(e.i(22361))}]);